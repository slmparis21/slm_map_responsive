<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Add custom icons with Markers</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js"></script>
<!-- <style>
/* #map { position: absolute; top: 0; bottom: 0; width: 100%; } */
</style> -->
<!-- <link rel="stylesheet" href="https://github.com/slmparis21/slm_map_responsive/style.css"> -->
<style>
body {
    margin: 0;
    padding: 0;
}

#contents{
    width: 100%;
    height:fit-content;
    display:inline-block;
}

#cats p{
    font-size: 10px;
}

a#storeNames {
    margin-left: 15px;
    height: fit-content;
    width: fit-content;
    display: block;
    font-size: 15px;
    margin-top: 2px;
    text-decoration: none;
    color: black;
}

li{
    display: inline-block;
    height:2em;
    margin-top:auto;
    margin-bottom:auto;
    padding-left:10px;
}


/*map*/


#map {
position: relative;
top: 0;
right: 0;
bottom: 0;
width: 500px;
height:auto;
width: 800px;
height: 400px;
}

.marker {
display: block;
border: none;
box-sizing:90%;
cursor: pointer;
padding: 0;
}

.mapboxgl-popup {
max-width: 200px;
}

.mapboxgl-popup-content {
text-align: center;
font-family: 'Open Sans', sans-serif;
}


h2{
    font-size:15px;
}
  
button.accordion {
    width: 95%;
    display: flex;
    background-color: rgb(255, 255, 255);
    text-align: left;
    border: none;
    outline: none;
    transition: 0.4s;
    cursor: pointer;
    padding: 18px;
    height: 2em;
    font-size: 15px;
    align-items: center;
  
}
  
button.accordian:hover{
    background-color:#ccc;
}


.active, .accordion:hover {
    background-color: #ccc;
}
#storeNames:hover{
  background-color: #ccc;

}
  
.panel {
    padding: 0 18px;
    background-color: white;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
}
  
@media (min-width:768px){


    li#cats {
        width: 30%;
        height: auto;
    }


    li#map{
        width: 60%;
    }
    #contents {
        width: 100%;
        display: inline-flex;
    }

}
@media (max-width:768px) {
    #contents {
        width: 100%;
        display: inline-block;
    }

    li#cats {
        width: 100%;
        height: auto;
    }


    li#map{
        width: 90%;
        display: inline-flex;
        margin:20px;
        
    }

    
}
	
	
</style>
</head>
<body>
<div id="contents">
<li id="cats">
  <!-- <p>${countries[0]}</p> -->
</li>
<li id="map"></div>
</li>
<script src="https:////cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" charset="utf-8"></script>
<script>
	
  const geojson={
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "name": "Aromateka",
        "lat": "55.74200165",
        "lon": "37.60327234",
        "address": "Znamenka Ulitsa, 7/3, Пушкино, Moskovskaya oblast, Russia, 119019",
        "country": "Russia",
        "city": "Moscow",
        "code": "7",
        "link": "https://aroma-teka.ru/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.603272,
          55.742002
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Parfümerie Aurel",
        "lat": "52.60486322",
        "lon": "11.86260375",
        "address": "Breite Str. 75, Stendal",
        "country": "Germany",
        "city": "Stendal",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          11.862604,
          52.604863
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Aus Liebe Zum Duft",
        "lat": "49.1381556",
        "lon": "8.586216371",
        "address": "Zeiloch 9, Bruchsal",
        "country": "Germany",
        "city": "Bruchsal",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          8.586216,
          49.138156
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Balduin",
        "lat": "48.05103123",
        "lon": "10.89396432",
        "address": "Adlerstraße 15 86899 Landsberg am Lech, Germany",
        "country": "Germany",
        "city": "Landsberg",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          10.893964,
          48.051031
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Basic Crème de la Crème",
        "lat": "49.2555133",
        "lon": "4.0314917",
        "address": "21 Rue des Élus, 51100 Reims -",
        "country": "France",
        "city": "Remis",
        "code": "33",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.031492,
          49.255513
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Bercalina",
        "lat": "42.69829107",
        "lon": "9.450425213",
        "address": "2 rue Neuve Saint Roch, Bastia",
        "country": "France",
        "city": "Bastia",
        "code": "33",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          9.450425,
          42.698291
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cour des Hommes",
        "lat": "49.117584",
        "lon": "6.174013",
        "address": "11 Rue des Clercs, 57000 Metz, France",
        "country": "France",
        "city": "Metz",
        "code": "33",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          6.174013,
          49.117584
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Eiffel",
        "lat": "55.749283",
        "lon": "37.607453",
        "address": "Ulitsa Kuybysheva, 26, Vladikavkaz, Северная Осетия-Алания республика",
        "country": "Russia",
        "city": "Vladikavkaz",
        "code": "7",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.607453,
          55.749283
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Fablab",
        "lat": "59.31296891",
        "lon": "18.0778694",
        "address": "Bondegatan 7, Stockholm",
        "country": "Sweden",
        "city": "Stockholm",
        "code": "46",
        "link": "https://fab-lab.nu/collections/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          18.077869,
          59.312969
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Giorgio",
        "lat": "59.93428",
        "lon": "30.335099",
        "address": "18-1 A Uchitel skaya st.,St. Petersburg",
        "country": "Russia",
        "city": "Petersburg",
        "code": "7",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          30.335099,
          59.93428
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Harvey Nichols",
        "lat": "51.501584",
        "lon": "-0.159805",
        "address": "109-125 Knightsbridge, Belgravia, London SW1X 7RJ, UK",
        "country": "UK",
        "city": "London",
        "code": "44",
        "link": "https://www.harveynichols.com/search/sous%20le%20manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.159805,
          51.501584
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Hyrv Concept Store",
        "lat": "59.43973086",
        "lon": "24.75655431",
        "address": "Rotermanni 7, Tallinn",
        "country": "Estonia",
        "city": "Tallinn",
        "code": "372",
        "link": "https://www.hyrv.co/perfumes/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          24.756554,
          59.439731
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Identité Parfumerie",
        "lat": "47.74769212",
        "lon": "7.337457078",
        "address": "3 rue des Bons Enfants, Muhlouse",
        "country": "France",
        "city": "Mulhouse",
        "code": "33",
        "link": "https://www.identite-parfumerie.fr/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          7.337457,
          47.747692
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Impressium",
        "lat": "52.23046019",
        "lon": "21.02084547",
        "address": "Mysia 3 00-496 Varsovie",
        "country": "Poland",
        "city": "Varsovie",
        "code": "48",
        "link": "https://impressium.pl/37_sous-le-manteau"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          21.020845,
          52.23046
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Impressium",
        "lat": "51.75158547",
        "lon": "19.46009643",
        "address": "Piotrkowska 243 90-456 Łódź",
        "country": "Poland",
        "city": "Łódź",
        "code": "48",
        "link": "https://impressium.pl/37_sous-le-manteau"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          19.460096,
          51.751585
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Indigo Perfumery",
        "lat": "41.48386589",
        "lon": "-81.771735",
        "address": "12011 Detroit Ave, Lakewood, OH 44107",
        "country": "United States",
        "city": "Lakewood",
        "code": "1",
        "link": "https://indigoperfumery.com/collections/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -81.771735,
          41.483866
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Kurfürsten Parfümerie",
        "lat": "49.48622848",
        "lon": "8.473097957",
        "address": "P7 24, Mannheim",
        "country": "Germany",
        "city": "Mannheim",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          8.473098,
          49.486228
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "La Majestueuse",
        "lat": "44.83876245",
        "lon": "-0.5791792597",
        "address": "73 rue des Remparts, Bordeaux",
        "country": "France",
        "city": "Bordeaux",
        "code": "33",
        "link": "https://lamajestueuse.fr/parfums-rares/parfums-sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.579179,
          44.838762
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Le Paravent",
        "lat": "45.75326573",
        "lon": "4.83094887",
        "address": "35 rue Auguste Comte, Lyon",
        "country": "France",
        "city": "Lyon",
        "code": "33",
        "link": "https://le-paravent.fr/parfum-de-niche/sous-le-manteau--115/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.830949,
          45.753266
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Le Secret du Marais",
        "lat": "40.425267",
        "lon": "-3.69778",
        "address": "Calle Hortaleza, 75 28004 Madrid",
        "country": "Spain",
        "city": "Madrid",
        "code": "34",
        "link": "https://www.lesecretdumarais.com/es/590-sous-le-manteau"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.69778,
          40.425267
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lukse",
        "lat": "55.026864",
        "lon": "82.925049",
        "address": "Serebrennikovskaya Ulitsa, 31, Novosibirsk",
        "country": "Russia",
        "city": "Novosibirsk",
        "code": "7",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          82.925049,
          55.026864
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Omar",
        "lat": "23.580222",
        "lon": "58.564049",
        "address": "Muscat Oman",
        "country": "Middle East",
        "city": "Oman",
        "code": "968",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          58.564049,
          23.580222
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Parfumerie Brückner",
        "lat": "48.13671696",
        "lon": "11.57598488",
        "address": "Kaufingerstraße 28",
        "country": "Germany",
        "city": "Berlin",
        "code": "49",
        "link": "https://www.parfuemerie-brueckner.com/collections/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          11.575985,
          48.136717
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Parfumerie Christophe",
        "lat": "50.84645418",
        "lon": "4.34843504",
        "address": "Groenlaan 9, Herzele",
        "country": "Belgium",
        "city": "Herzele",
        "code": "32",
        "link": "https://www.parfumerie-christophe.be/productcategorie/parfums/?product_tag=sous-le-manteau"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.348435,
          50.846454
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Parfums Uniques",
        "lat": "48.132303",
        "lon": "11.576714",
        "address": "Klenzestrasse 22 (at Gärtnerplatz) , 80469 Munich",
        "country": "Germany",
        "city": "Munich",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          11.576714,
          48.132303
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rosamundi",
        "lat": "44.46052332",
        "lon": "26.10036475",
        "address": "Agora Floreasca building, etaj 1 Calea Floreasca 111–113, Bucharest",
        "country": "Romania",
        "city": "Bucharest",
        "code": "40",
        "link": "https://rosamundiperfumery.com/p/brand/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          26.100365,
          44.460523
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Sens Unique",
        "lat": "48.856095",
        "lon": "2.358783",
        "address": "13 Rue du Roi de Sicile, 75004 Paris -",
        "country": "France",
        "city": "Paris",
        "code": "33",
        "link": "https://shop.sensuniqueparis.com/fr/68-slm-sous-le-manteau-/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          2.358783,
          48.856095
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Space240",
        "lat": "40.741717",
        "lon": "-73.978676",
        "address": "240 East 29th st, New York",
        "country": "United States",
        "city": "New York",
        "code": "1",
        "link": "https://www.space240.com/sous-le-manteau-collection/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -73.978676,
          40.741717
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Spitzenhaus",
        "lat": "47.368124",
        "lon": "8.540685",
        "address": "Börsenstrasse 14, 8001 Zürich",
        "country": "Switzerland",
        "city": "Zurich",
        "code": "41",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          8.540685,
          47.368124
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Swan Parfümerie",
        "lat": "48.40384889",
        "lon": "12.76271351",
        "address": "Stadtpl. 29, 84307 Eggenfelden, Allemagne",
        "country": "Germany",
        "city": "Eggenfelden",
        "code": "49",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          12.762714,
          48.403849
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Zgo",
        "lat": "37.7593493",
        "lon": "-122.4350598",
        "address": "600 Castro street, San Francisco",
        "country": "United States",
        "city": "San Francisco",
        "code": "1",
        "link": "https://www.zgoperfumery.com/sous-le-manteau/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.43506,
          37.759349
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "La Maison de la Parfumeria",
        "lat": "48.48845862",
        "lon": "135.0839907",
        "address": "TC Plaza, Karla Marksa 76a, Khabarovsk",
        "country": "Russia",
        "city": "Khabarovsk",
        "code": "7",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          135.083991,
          48.488459
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Renee Parfums",
        "lat": "59.93957671",
        "lon": "30.35250366",
        "address": "BASKOV LANE, 5, Saint Petersburg",
        "country": "Russia",
        "city": "St. Petersburg",
        "code": "7",
        "link": "https://reneeparfum.ru/index.php?route=product/category&path=20_113/"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          30.352504,
          59.939577
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Imagine",
        "lat": "56.83882847",
        "lon": "60.59502494",
        "address": "Prospekt Lenina 25, mall Europa, Yekaterinburg 620014",
        "country": "Russia",
        "city": "Yekaterinburg",
        "code": "7",
        "link": "https://imagine-parfum.ru/brand/156-sous-le-manteau.html"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          60.595025,
          56.838828
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Place Shop",
        "lat": "58.01347733",
        "lon": "56.23727981",
        "address": "PERM, SOVETSKAYA ST 28A",
        "country": "Russia",
        "city": "Perm",
        "code": "7",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          56.23728,
          58.013477
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Bethabosem",
        "lat": "32.08793620697620",
        "lon": "34.791119633444300",
        "address": "TEL AVIV, Arieh Akiva St 1",
        "country": "Israel",
        "city": "Akiva",
        "code": "972",
        "link":""
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
          34.79112,
          32.087936
        ]
      }
    }
  ]
}
mapboxgl.accessToken = 'pk.eyJ1IjoienNvbmcwMDAiLCJhIjoiY2wzZDYxN3g1MDVhYjNqazFzOGdodWV5bCJ9.oyaViQeE9nsbCMloG2aCqA';


// mapboxgl.accessToken = 'pk.eyJ1IjoienNvbmcwMDAiLCJhIjoiY2tuOGZpam1hMHhqeDJ1cW5ybnk2YWY5aSJ9.Qvp2VueePF0Ss_IPcmtdNA';

const countries=[
  "Belgium",
  "Estonia",
  "France",
  "Germany",
  "Japan",
  "Israel",
  "Middle East",
  "Poland",
  "Romania",
  "Russia",
  "Spain",
  "Sweden",
  "Switerland",
  "United States",
  "United Kingdom"
];



const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/zsong000/cktqgt8h803ac17s4nlxt23fr',
        center: [4.804297,
          43.9497271],
        zoom: 2
    });

    // Add markers to the map.
for (const marker of geojson.features) {
  // Create a DOM element for each marker.
  const el = document.createElement('div');
  const width = 30;
  const height=30;
  el.className = 'marker';
  el.style.backgroundImage = `url(https://image.ibb.co/hws0ZK/slm_map_icon.png/${width}/${height}/)`;
  el.style.width = `${width}px`;
  el.style.height = `${height}px`;
  el.style.backgroundSize = '100%';
  new mapboxgl.Marker(el)
    .setLngLat(marker.geometry.coordinates)
    .setPopup(
  new mapboxgl.Popup({ offset: 25 }) // add popups
    .setHTML(`<h3>${marker.properties.name}</h3><p>${marker.properties.address}</p>`)
  )
  .addTo(map);
}





let stores=[];
// let stores=[];
let storeName=[];
let countryName = [];
///////////
for(let i=0;i<countries.length;i++){
  let storeInfo={};
  storeInfo['country']=countries[i];
  stores.push(storeInfo);
}
// console.log(stores);
for(let i =0;i<stores.length;i++){
  stores[i].name=[];
  stores[i].link=[];
  let caseVal=stores[i].country;
  for(const obj of geojson.features){
    switch(obj.properties.country){
        
        case caseVal:
        let cityVal=obj.properties.city;
        let linkVal= obj.properties.link;
        stores[i].name.push(obj.properties.name+', '+cityVal);
        stores[i].link.push(linkVal);
        // console.log(cityVal);
        // stores[i].name.city.push(cityVal);
        break;
    }
  }

}
console.log(stores);
let id = 0;

countries.forEach(country => {

  
  let div= document.getElementById('cats');
  var newName = document.createElement("button");
  newName.className="accordion";

  newName.innerHTML=`<strong>${country} \u2727</strong>&nbsp`;
  var newPanel = document.createElement("div");
  newPanel.className='panel';
  div.append(newName);

  // console.log(n);
  let newId = 0;
  // console.log(stores[id].name);

  for(n of stores[id].name){
   
    newPanel.innerHTML+=`<a id="storeNames" href="${stores[id].link[newId]}" target="_blank">${stores[id].name[newId]}</a>`;
   
    div.append(newPanel);
    // console.log(stores[id].name[newId]);

    newId++;
  }
  id++;
});

</script>
<script>

var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
  acc[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var panel = this.nextElementSibling;
    if (panel.style.maxHeight) {
      panel.style.maxHeight = null;
    } else {
      panel.style.maxHeight = panel.scrollHeight + "px";
    } 
  });
 
}

 </script>
</body>
</html>
